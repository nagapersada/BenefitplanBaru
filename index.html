<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DVTEAM NP - Benefit Plan</title>
    
    <meta name="theme-color" content="#020617">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="/BenefitPlan/manifest.json">
    <link rel="apple-touch-icon" href="/BenefitPlan/images/apple-touch-icon.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
         body { font-family: 'Inter', sans-serif; background-color: #020617; background-image: radial-gradient(ellipse at top, #1e293b, #020617); color: #cbd5e1; overflow: hidden; }
        #splash-screen { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; padding: 1.5rem; text-align: center; animation: fadeIn 1s ease-out forwards; position: fixed; top: 0; left: 0; width: 100%; z-index: 100; background-color: #020617; }
        .splash-logo { max-width: 300px; width: 100%; height: auto; margin-bottom: 1.5rem; filter: drop-shadow(0 0 10px rgba(255,255,255,0.1)); }
        .splash-title { font-size: 2rem; font-weight: 800; color: #f0f9ff; letter-spacing: -0.025em; text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3); }
        .splash-subtitle { font-size: 1rem; color: #94a3b8; margin-top: 0.5rem; max-width: 400px; }
        .enter-button { margin-top: 2.5rem; background: linear-gradient(to right, #eab308, #f59e0b); color: #1e293b; padding: 0.75rem 2rem; font-weight: 700; border-radius: 0.5rem; box-shadow: 0 4px 20px -1px rgb(234 179 8 / 0.4); transition: all 0.3s ease; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); }
        .enter-button:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 7px 25px -1px rgb(234 179 8 / 0.6); }
        #dashboard-content { display: none; height: 100vh; overflow-y: auto; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-10px);} } 
        @keyframes pulse-update { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes blink { 0%, 100% { opacity: 1; text-shadow: 0 0 15px #fcd34d, 0 0 5px #fef3c7; } 50% { opacity: 0.2; text-shadow: none; } }
        .juara-text { animation: blink 0.8s infinite alternate; background: linear-gradient(to right, #facc15, #fbbf24, #eab308); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .card { background-color: rgba(30, 41, 59, 0.7); border-radius: 1rem; border: 1px solid rgba(255, 255, 255, 0.08); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); }
        .number-pulse { animation: pulse-update 0.4s ease-out; }
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; pointer-events: none; display: none; }
        
        /* Updated Elegant Icon Button Styles */
        .action-btn-icon-only { display: flex; align-items: center; justify-content: center; background-color: rgba(30, 41, 59, 0.5); color: #94a3b8; border: 1px solid rgba(148, 163, 184, 0.2); width: 50px; height: 50px; border-radius: 1rem; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; backdrop-filter: blur(4px); }
        .action-btn-icon-only:hover:not(:disabled) { background-color: rgba(51, 65, 85, 0.8); color: #f1f5f9; border-color: rgba(148, 163, 184, 0.4); box-shadow: 0 0 15px rgba(148, 163, 184, 0.1); transform: translateY(-2px); }
        .action-btn-icon-only:disabled { background-color: rgba(30, 41, 59, 0.3); color: #475569; border-color: rgba(148, 163, 184, 0.1); opacity: 0.7; cursor: not-allowed; }
        .action-btn-icon-only.clicked { background: linear-gradient(135deg, #065f46, #059669); color: #ecfdf5; border-color: transparent; box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3); }
        .action-btn-icon-only svg { stroke-width: 1.5; /* Thinner strokes for elegance */ }
        
        .action-item { display: flex; flex-direction: column; align-items: center; }
        .action-label { margin-top: 0.5rem; font-size: 0.7rem; font-weight: 500; letter-spacing: 0.02em; color: #94a3b8; text-align: center; text-transform: uppercase; }
        
        /* Checkbox refinement */
        input[type="checkbox"]:checked + label { box-shadow: 0 0 10px rgba(99, 102, 241, 0.3); border-color: #6366f1; }
        .duplication-badge { font-variant-numeric: tabular-nums; letter-spacing: -0.05em; }
    </style>
</head>
<body>

    <div id="splash-screen">
        <img src="/BenefitPlan/images/logo-splash.png" alt="DVTEAM NP Logo" class="splash-logo" onerror="this.src='https://placehold.co/300x100/1e293b/cbd5e1?text=DVTEAM+NP';this.onerror=null;">
        <h1 class="splash-title">Raih Potensi Puncak Anda</h1>
        <p class="splash-subtitle">Selamat datang di Simulator Benefit Plan. Alat bantu eksklusif untuk merancang masa depan dan kesuksesan tim Anda.</p>
        <button id="enter-button" class="enter-button">MASUK SIMULATOR</button>
    </div>

    <div id="dashboard-content">
        <canvas id="confetti-canvas"></canvas>
        <div class="container mx-auto p-4 md:p-6 max-w-6xl relative z-10">
            <header class="text-center mb-8">
               <div class="flex justify-center items-center">
                    <h1 class="text-2xl md:text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-slate-100 to-slate-400 tracking-tight">Dashboard Proyeksi</h1>
                    <button id="play-audio-button" title="Putar Panduan Audio" class="ml-4 text-slate-500 hover:text-cyan-400 transition-colors duration-300 p-2 bg-slate-800/50 rounded-full backdrop-blur-sm border border-slate-700/50">
                        <svg id="speaker-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a3 3 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z" />
                        </svg>
                        <svg id="speaker-off-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 hidden">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z" />
                        </svg>
                    </button>
                </div>
                <p class="text-slate-500 mt-2 max-w-lg mx-auto text-sm font-medium">Perencanaan strategis untuk memaksimalkan potensi tim.</p>
            </header>
    
            <div class="grid grid-cols-1 gap-4">
                <div class="space-y-4">
                     <div class="card p-5">
                        <div class="space-y-3 px-1">
                            <div class="flex justify-between items-center text-sm"><span class="text-slate-400 font-medium">Bonus Reveral Lv.1</span><span class="font-bold text-emerald-400" id="resBonusReveral1"></span></div>
                            <div class="flex justify-between items-center text-sm"><span class="text-slate-400 font-medium">Bonus Reveral Lv.2</span><span class="font-bold text-emerald-400" id="resBonusReveral2"></span></div>
                            <div class="flex justify-between items-center text-sm border-t border-slate-700/50 pt-2"><span class="text-slate-300 font-semibold">Bonus Tim</span><span class="font-extrabold text-emerald-400" id="resBonusTim"></span></div>
                        </div>
                    </div>
    
                    <div class="card p-6 pb-32 sticky top-4 z-20 shadow-xl ring-1 ring-white/10">
                        <div class="flex items-start justify-between mb-6">
                            
                            <div class="space-y-4 flex-1 pr-4"> 
                                <div class="flex flex-col justify-start items-start">
                                    <div class="flex items-center space-x-2">
                                        <div id="anda-label" class="bg-blue-500/20 text-blue-300 font-bold text-[0.65rem] px-3 py-1 rounded-full transition-colors duration-300 tracking-wider border border-blue-500/30">ANDA</div>
                                        <div id="crown-icon" class="hidden drop-shadow-[0_0_8px_rgba(251,191,36,0.5)]"><span class="text-lg">ðŸ‘‘</span></div>
                                    </div>
                                    <div id="ketua-tim-label" class="mt-1 h-5"></div>
                                </div>
                                
                                <div>
                                    <p class="text-[0.65rem] text-slate-500 font-bold uppercase tracking-widest mb-1">Status & Peringkat</p>
                                    <div class="flex items-center space-x-3 mt-1 whitespace-nowrap">
                                        <div id="kpiStatus"></div>
                                        <div id="kpiBonusPeringkat" class="font-extrabold text-emerald-400 text-xl bg-clip-text text-transparent bg-gradient-to-r from-emerald-400 to-teal-300"></div>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4 pt-2">
                                    <div>
                                        <p class="text-[0.65rem] text-slate-500 font-bold uppercase tracking-widest mb-1">Batasan Modal</p>
                                        <p class="font-bold text-slate-100 text-lg tracking-tight" id="resBatasanModal"></p>
                                    </div>
                                    <div>
                                        <p class="text-[0.65rem] text-slate-500 font-bold uppercase tracking-widest mb-1">Total Anggota</p>
                                        <p class="font-bold text-slate-100 text-lg tracking-tight" id="resTotalAnggotaPanel"></p>
                                    </div>
                                </div>
                                
                                <div class="space-y-2 pt-3 border-t border-slate-700/50" id="sinyalContainer">
                                    </div>

                                 <div id="action-button-container" class="pt-5 mt-5 border-t border-slate-700/50 relative">
                                    <div id="phase-1-buttons" class="grid grid-cols-4 gap-3 w-full relative z-10"> 
                                        <div class="action-item"> <button id="btn-tanya" onclick="handlePhase1Click('tanya')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M12 17.25h.008v.008H12v-.008Z" /></svg>
                                        </button> <span class="action-label">Tanya</span> </div>
                                        <div class="action-item"> <button id="btn-cerita" onclick="handlePhase1Click('cerita')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" /></svg>
                                        </button> <span class="action-label">Cerita</span> </div>
                                        <div class="action-item"> <button id="btn-undang" onclick="handlePhase1Click('undang')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z" /></svg>
                                        </button> <span class="action-label">Undang</span> </div>
                                        <div class="action-item"> <button id="btn-jelaskan" onclick="handlePhase1Click('jelaskan')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 21h16.5M12 3v16.5m0 0L7.5 12m4.5 7.5L16.5 12" /></svg>
                                        </button> <span class="action-label">Jelaskan</span> </div>
                                    </div>
                                    <div id="phase-2-buttons" class="hidden grid grid-cols-4 gap-3 w-full relative z-10">
                                        <div class="action-item"> <button id="btn-sapa" onclick="handlePhase2Click('sapa')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575V12a6.75 6.75 0 0 0 6.75 6.75H18a2.25 2.25 0 0 0 2.25-2.25V9m-12.862 3v-1.575c0-.698.426-1.339 1.072-1.616L12 4.575" /></svg>
                                        </button> <span class="action-label">Sapa</span> </div>
                                        <div class="action-item"> <button id="btn-sharing" onclick="handlePhase2Click('sharing')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z" /></svg>
                                        </button> <span class="action-label">Sharing</span> </div>
                                        <div class="action-item"> <button id="btn-solusi" onclick="handlePhase2Click('solusi')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-1.5m0 0a6.01 6.01 0 0 1-6-6v-1.5m6 7.5a6.01 6.01 0 0 0 6-6v-1.5m-6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z" /></svg>
                                        </button> <span class="action-label">Solusi</span> </div>
                                        <div class="action-item"> <button id="btn-duplikasi" onclick="handlePhase2Click('duplikasi')" class="action-btn-icon-only"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6" /></svg>
                                        </button> <span class="action-label">Duplikasi</span> </div>
                                    </div>
                                    <div id="phase-3-buttons" class="hidden grid grid-cols-4 gap-3 w-full relative z-10">
                                        <div class="col-start-2 action-item"> <button id="btn-edifikasi" onclick="handlePhase3Click('edifikasi')" class="action-btn-icon-only w-full"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" /></svg>
                                        </button> <span class="action-label">Edifikasi</span> </div>
                                        <div class="action-item"> <button id="btn-duplikasi-level" onclick="handlePhase3Click('duplikasi')" class="action-btn-icon-only w-full"> 
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" /></svg>
                                        </button> <span class="action-label">Duplikasi</span> </div>
                                    </div>
                                 </div>
                            </div>
                            
                            <div class="text-right space-y-4 flex flex-col justify-between h-full pl-4 border-l border-slate-700/50"> 
                                <div>
                                    <p class="text-[0.65rem] text-slate-500 font-bold uppercase tracking-widest mb-1">Total Bonus</p>
                                    <p class="text-2xl font-black text-transparent bg-clip-text bg-gradient-to-br from-cyan-300 to-blue-500" id="kpiTotalBonus"></p>
                                </div>
                                <div>
                                    <p class="text-[0.65rem] text-slate-500 font-bold uppercase tracking-widest mb-1">Saldo Akun</p>
                                    <p class="font-bold text-white text-xl tracking-tight" id="resModalAwalPanel"></p>
                                </div>
                                <div>
                                    <p class="text-[0.65rem] text-slate-500 font-bold uppercase tracking-widest mb-1">Bonus Volume</p>
                                    <p class="font-bold text-cyan-300 text-xl tracking-tight" id="resBonusVolume"></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-5 pt-5 border-t border-slate-700/50" id="controls-body">
                             </div>
                        
                        <div id="fokus-message" class="mt-8 text-center"><p class="text-sm font-bold uppercase text-amber-400/90 tracking-wider glow-sm">Fokus Kepada 5 Anggota</p></div>
                        <div id="juara-message-container" class="mt-8 text-center hidden"><h3 class="juara-text text-3xl md:text-4xl font-extrabold tracking-wider filter drop-shadow-lg">SELAMAT ANDA JUARA..!!</h3></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <audio id="tutorial-audio" src="benefit(2).mp3" preload="auto"></audio>
    <audio id="champions-audio" src="Champions (2).mp3" preload="auto"></audio>

    <script>
        // --- Deklarasi Variabel Global ---
        let anggotaLevels = [0, 0, 0, 0, 0]; 
        let simulationMode = 'recruit_lv1'; 
        let memberState = {};
        let phase1ButtonsClicked = { tanya: false, cerita: false, undang: false, jelaskan: false }; 
        let phase2ButtonsClicked = { sapa: false, sharing: false, solusi: false, duplikasi: false };
        let phase3ButtonsClicked = { edifikasi: false, duplikasi: false };
        let currentMemberIndex = 0; let currentBinaIndex = 0;   
        let currentDuplicationState = { level: 2, memberIndex: 0 }; 
        const members = ['A', 'B', 'C', 'D', 'E'];
        let currentPhase = 1; 
        let confettiInterval; let animationFrameId;

        // --- Definisi Fungsi Simulator (Global Scope) ---
        function resetMemberState() { memberState = { A: { isLeader: false, duplicationLevels: 0 }, B: { isLeader: false, duplicationLevels: 0 }, C: { isLeader: false, duplicationLevels: 0 }, D: { isLeader: false, duplicationLevels: 0 }, E: { isLeader: false, duplicationLevels: 0 }, }; }
        function handlePhase1Click(buttonName) { if (currentPhase !== 1) return; phase1ButtonsClicked[buttonName] = true; const btn = document.getElementById(`btn-${buttonName}`); if (btn) { btn.disabled = true; btn.classList.add('clicked'); } else { console.error(`Button ${buttonName} not found`); return; } const allClicked = Object.values(phase1ButtonsClicked).every(val => val === true); if (allClicked) { if (currentMemberIndex < members.length) { const memberLetter = members[currentMemberIndex]; const checkbox = document.getElementById(`member${memberLetter}`); if (checkbox) checkbox.checked = true; currentMemberIndex++; handleCheckboxChange(); if (currentMemberIndex < members.length) { setTimeout(resetPhase1Buttons, 500); } else { currentPhase = 2; const p1 = document.getElementById('phase-1-buttons'); if(p1) p1.classList.add('hidden'); const p2 = document.getElementById('phase-2-buttons'); if(p2) p2.classList.remove('hidden'); const lbl = document.getElementById('controls-label'); if(lbl) lbl.textContent = "Membangun Ketua Tim"; } } } }
        function resetPhase1Buttons() { phase1ButtonsClicked = { tanya: false, cerita: false, undang: false, jelaskan: false }; ['tanya', 'cerita', 'undang', 'jelaskan'].forEach(name => { const btn = document.getElementById(`btn-${name}`); if (btn) { btn.disabled = false; btn.classList.remove('clicked'); } }); }
        function handlePhase2Click(buttonName) { if (currentPhase !== 2) return; phase2ButtonsClicked[buttonName] = true; const btn = document.getElementById(`btn-${buttonName}`); if (btn) { btn.disabled = true; btn.classList.add('clicked'); } else { return; } const allClicked = Object.values(phase2ButtonsClicked).every(val => val === true); if (allClicked) { if (currentBinaIndex < members.length) { const memberLetter = members[currentBinaIndex]; if (currentBinaIndex === 0) { simulationMode = 'duplicating_lv1'; renderControls(); } memberState[memberLetter].isLeader = true; memberState[memberLetter].duplicationLevels = 1; updateSimulation(); currentBinaIndex++; if (currentBinaIndex < members.length) { setTimeout(resetPhase2Buttons, 500); } else { currentPhase = 3; const p2 = document.getElementById('phase-2-buttons'); if(p2) p2.classList.add('hidden'); const p3 = document.getElementById('phase-3-buttons'); if(p3) p3.classList.remove('hidden'); } } } }
        function resetPhase2Buttons() { phase2ButtonsClicked = { sapa: false, sharing: false, solusi: false, duplikasi: false }; ['sapa', 'sharing', 'solusi', 'duplikasi'].forEach(name => { const btn = document.getElementById(`btn-${name}`); if (btn) { btn.disabled = false; btn.classList.remove('clicked'); } }); }
        function handlePhase3Click(buttonName) { if (currentPhase !== 3) return; phase3ButtonsClicked[buttonName] = true; const btnId = (buttonName === 'duplikasi') ? 'btn-duplikasi-level' : 'btn-edifikasi'; const btn = document.getElementById(btnId); if (btn) { btn.disabled = true; btn.classList.add('clicked'); } else { return; } const allClicked = Object.values(phase3ButtonsClicked).every(val => val === true); if (allClicked) { const { level, memberIndex } = currentDuplicationState; if (level > 4) return; const memberLetter = members[memberIndex]; memberState[memberLetter].duplicationLevels = level; updateSimulation(); let newMemberIndex = memberIndex + 1; let newLevel = level; if (newMemberIndex >= members.length) { newMemberIndex = 0; newLevel = level + 1; } currentDuplicationState = { level: newLevel, memberIndex: newMemberIndex }; if (newLevel <= 4) { setTimeout(resetPhase3Buttons, 500); } } }
        function resetPhase3Buttons() { phase3ButtonsClicked = { edifikasi: false, duplikasi: false }; const btnEd = document.getElementById('btn-edifikasi'); if(btnEd) { btnEd.disabled = false; btnEd.classList.remove('clicked'); } const btnDup = document.getElementById('btn-duplikasi-level'); if(btnDup) { btnDup.disabled = false; btnDup.classList.remove('clicked'); } }
        function goBackOneStep() { stopConfetti(); const championsAudio = document.getElementById('champions-audio'); if (championsAudio && !championsAudio.paused) championsAudio.pause(); if (currentPhase === 3) { let { level, memberIndex } = currentDuplicationState; let prevMemberIndex = memberIndex - 1; let prevLevel = level; if (prevMemberIndex < 0) { prevMemberIndex = 4; prevLevel = level - 1; } if (prevLevel < 2) { currentPhase = 2; currentBinaIndex = 5; const p3 = document.getElementById('phase-3-buttons'); if(p3) p3.classList.add('hidden'); const p2 = document.getElementById('phase-2-buttons'); if(p2) p2.classList.remove('hidden'); resetPhase2Buttons(); } else { const memberToRevert = members[prevMemberIndex]; memberState[memberToRevert].duplicationLevels = prevLevel - 1; currentDuplicationState = { level: prevLevel, memberIndex: prevMemberIndex }; resetPhase3Buttons(); updateSimulation(); } } else if (currentPhase === 2) { if (currentBinaIndex === 0) { currentPhase = 1; currentMemberIndex = 5; simulationMode = 'recruit_lv1'; const p2 = document.getElementById('phase-2-buttons'); if(p2) p2.classList.add('hidden'); const p1 = document.getElementById('phase-1-buttons'); if(p1) p1.classList.remove('hidden'); resetPhase1Buttons(); renderControls(); } else { currentBinaIndex--; const memberToRevert = members[currentBinaIndex]; memberState[memberToRevert].isLeader = false; memberState[memberToRevert].duplicationLevels = 0; resetPhase2Buttons(); updateSimulation(); } } else if (currentPhase === 1) { if (currentMemberIndex > 0) { currentMemberIndex--; const memberToUncheck = members[currentMemberIndex]; const cb = document.getElementById(`member${memberToUncheck}`); if(cb) cb.checked = false; resetPhase1Buttons(); handleCheckboxChange(); } } }
        function initializeSimulator() { console.log("Initializing Simulator..."); stopConfetti(); const championsAudio = document.getElementById('champions-audio'); if (championsAudio && !championsAudio.paused) championsAudio.pause(); resetMemberState(); simulationMode = 'recruit_lv1'; phase1ButtonsClicked = { tanya: false, cerita: false, undang: false, jelaskan: false }; phase2ButtonsClicked = { sapa: false, sharing: false, solusi: false, duplikasi: false }; phase3ButtonsClicked = { edifikasi: false, duplikasi: false }; currentMemberIndex = 0; currentBinaIndex = 0; currentDuplicationState = { level: 2, memberIndex: 0 }; currentPhase = 1; const p1=document.getElementById('phase-1-buttons'); if(p1) p1.classList.remove('hidden'); const p2=document.getElementById('phase-2-buttons'); if(p2) p2.classList.add('hidden'); const p3=document.getElementById('phase-3-buttons'); if(p3) p3.classList.add('hidden'); resetPhase1Buttons(); resetPhase2Buttons(); resetPhase3Buttons(); renderControls(); members.forEach(letter => { const cb = document.getElementById(`member${letter}`); if (cb) cb.checked = false; }); handleCheckboxChange(); const lbl = document.getElementById('controls-label'); if(lbl) lbl.textContent = "Membangun Anggota Tim"; }
        function switchTab(tabName) { console.log(`Tab switch requested to ${tabName}, but tab UI is removed.`); }
        function handleCheckboxChange() { 
            if (simulationMode === 'recruit_lv1') { 
                anggotaLevels[0] = currentMemberIndex; 
            } 
            updateSimulation(); 
        }
       function renderControls() { 
            const container = document.getElementById('controls-body'); if(!container) { console.error("controls-body not found!"); return; } 
            let labelText = "Membangun Anggota Tim"; if (currentPhase > 1) labelText = "Membangun Ketua Tim";
            let checkboxBaseStyle = "bg-slate-800/50 border-slate-700/50 text-slate-300 backdrop-blur-sm"; let checkboxCheckedStyle = "peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-500/80 peer-checked:shadow-[0_0_15px_rgba(99,102,241,0.4)]";
            if (simulationMode === 'duplicating_lv1') { labelText = "Membangun Ketua Tim"; checkboxBaseStyle = "bg-indigo-900/30 border-indigo-700/50 text-indigo-300 backdrop-blur-sm"; checkboxCheckedStyle = "peer-checked:bg-amber-500 peer-checked:text-white peer-checked:border-amber-400/80 peer-checked:shadow-[0_0_15px_rgba(245,158,11,0.4)]"; }
            let checkboxHTML = members.map(letter => `<div> <div id="kt-label-${letter}" class="text-center h-5 mb-1 drop-shadow-md"></div> <input type="checkbox" id="member${letter}" class="hidden peer" disabled> <label for="member${letter}" class="block p-3 text-center rounded-xl border ${checkboxBaseStyle} ${checkboxCheckedStyle} font-bold transition-all duration-300 text-sm opacity-90 hover:opacity-100">${letter}</label> <div class="mt-2 space-y-1 flex flex-col items-center"> <div id="duplication-tree-${letter}" class="flex flex-col items-center space-y-1.5"></div> </div> </div>`).join('');
            container.innerHTML = `<div class="flex justify-between items-center mb-3"> <label id="controls-label" class="block font-semibold text-slate-400 text-xs uppercase tracking-wider">${labelText}</label> <button id="back-button" title="Kembali" class="text-slate-400 hover:text-amber-400 p-1.5 rounded-full transition-all bg-slate-800/50 hover:bg-slate-700/50 border border-slate-700/50" onclick="goBackOneStep()"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"> <path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3" /> </svg> </button> </div> <div class="grid grid-cols-5 gap-2"> ${checkboxHTML} </div>`; 
            Object.entries(memberState).forEach(([letter, member]) => { const cb = document.getElementById(`member${letter}`); if (cb) { if (currentPhase === 1) cb.checked = (members.indexOf(letter) < currentMemberIndex); else cb.checked = member.isLeader; } });
            updateSimulation(); 
        }
        function renderDuplicationTree() { Object.entries(memberState).forEach(([letter, member]) => { const treeContainer = document.getElementById(`duplication-tree-${letter}`); if (treeContainer) { treeContainer.innerHTML = ''; if (member.isLeader) { for (let i = 1; i <= member.duplicationLevels; i++) { const numberValue = 5 ** i; const numberDiv = document.createElement('div'); numberDiv.className = "text-[0.6rem] font-bold text-slate-300 bg-slate-700/50 px-2 py-0.5 rounded-md border border-slate-600/30 duplication-badge"; numberDiv.textContent = numberValue.toLocaleString('id-ID'); treeContainer.appendChild(numberDiv); } } } }); }
        const confettiCanvas = document.getElementById('confetti-canvas'); const confettiCtx = confettiCanvas ? confettiCanvas.getContext('2d') : null; let confettiPieces = []; const confettiColors = ['#fde68a', '#facc15', '#eab308', '#d97706'];
        function startConfetti() { if (confettiInterval || !confettiCanvas) return; confettiCanvas.style.display = 'block'; confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight; confettiInterval = setInterval(() => { for (let i = 0; i < 20; i++) { createConfetti(); } }, 500); animateConfetti(); }
        function stopConfetti() { if (!confettiInterval) return; clearInterval(confettiInterval); confettiInterval = null; cancelAnimationFrame(animationFrameId); animationFrameId = null; setTimeout(() => { if (confettiCanvas && confettiCtx) { confettiCanvas.style.display = 'none'; confettiPieces = []; confettiCtx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height); } }, 3000); }
        function createConfetti() { if(confettiCanvas) confettiPieces.push({ x: Math.random() * confettiCanvas.width, y: -20, w: 5 + Math.random() * 10, h: 10 + Math.random() * 10, color: confettiColors[Math.floor(Math.random() * confettiColors.length)], rotation: Math.random() * 360, speedX: Math.random() * 4 - 2, speedY: 2 + Math.random() * 3, opacity: 1 }); }
        function animateConfetti() { if (!confettiCtx || !confettiCanvas) return; animationFrameId = requestAnimationFrame(animateConfetti); confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height); confettiPieces.forEach((piece, index) => { piece.y += piece.speedY; piece.x += piece.speedX; piece.rotation += piece.speedX; piece.opacity -= 0.005; if (piece.y > confettiCanvas.height || piece.opacity <= 0) { confettiPieces.splice(index, 1); } else { confettiCtx.save(); confettiCtx.translate(piece.x, piece.y); confettiCtx.rotate(piece.rotation * Math.PI / 180); confettiCtx.globalAlpha = piece.opacity; confettiCtx.fillStyle = piece.color; confettiCtx.fillRect(-piece.w / 2, -piece.h / 2, piece.w, piece.h); confettiCtx.restore(); } }); }
        
        function updateSimulation() { 
             if (simulationMode === 'duplicating_lv1') { anggotaLevels[0] = 5; anggotaLevels.fill(0, 1); Object.values(memberState).forEach(member => { if (member.isLeader) { if (member.duplicationLevels >= 1) anggotaLevels[1] += 5; if (member.duplicationLevels >= 2) anggotaLevels[2] += 25; if (member.duplicationLevels >= 3) anggotaLevels[3] += 125; if (member.duplicationLevels >= 4) anggotaLevels[4] += 625; } }); } 
             else { anggotaLevels[0] = currentMemberIndex; anggotaLevels.fill(0, 1); } 
            
            const totalAnggotaTim = anggotaLevels.reduce((a, b) => a + b, 0); 
            const totalAnggota = totalAnggotaTim + 1; 
            const depositAwal = 100; 

            const bonusTim = anggotaLevels[0] >= 5 ? 20 : 0; 
            
            let cumulativeBonusPeringkat = 0; if (anggotaLevels[0] >= 5) cumulativeBonusPeringkat += 50; if (totalAnggota >= 31) cumulativeBonusPeringkat += 100; if (totalAnggota >= 101) cumulativeBonusPeringkat += 200; if (totalAnggota >= 201) cumulativeBonusPeringkat += 400; if (totalAnggota >= 351) cumulativeBonusPeringkat += 600; if (totalAnggota >= 501) cumulativeBonusPeringkat += 1000; if (totalAnggota >= 901) cumulativeBonusPeringkat += 2000; if (totalAnggota >= 1601) cumulativeBonusPeringkat += 3000; if (totalAnggota >= 3501) cumulativeBonusPeringkat += 5000;
            let status = "Anggota", statusColor = "bg-yellow-500/20 text-yellow-300 border-yellow-500/30", bonusPeringkatForDisplay = 0; 
            if (totalAnggota >= 3501) { status = "VIP 9"; statusColor = "bg-violet-500/30 text-violet-200 border-violet-500/40 shadow-[0_0_15px_rgba(139,92,246,0.3)]"; bonusPeringkatForDisplay = 5000;} else if (totalAnggota >= 1601) { status = "VIP 8"; statusColor = "bg-violet-500/20 text-violet-300 border-violet-500/30"; bonusPeringkatForDisplay = 3000;} else if (totalAnggota >= 901) { status = "VIP 7"; statusColor = "bg-indigo-500/20 text-indigo-300 border-indigo-500/30"; bonusPeringkatForDisplay = 2000;} else if (totalAnggota >= 501) { status = "VIP 6"; statusColor = "bg-indigo-500/20 text-indigo-300 border-indigo-500/30"; bonusPeringkatForDisplay = 1000;} else if (totalAnggota >= 351) { status = "VIP 5"; statusColor = "bg-blue-500/20 text-blue-300 border-blue-500/30"; bonusPeringkatForDisplay = 600;} else if (totalAnggota >= 201) { status = "VIP 4"; statusColor = "bg-blue-500/20 text-blue-300 border-blue-500/30"; bonusPeringkatForDisplay = 400;} else if (totalAnggota >= 101) { status = "VIP 3"; statusColor = "bg-cyan-500/20 text-cyan-300 border-cyan-500/30"; bonusPeringkatForDisplay = 200;} else if (totalAnggota >= 31) { status = "VIP 2"; statusColor = "bg-cyan-500/20 text-cyan-300 border-cyan-500/30"; bonusPeringkatForDisplay = 100;} else if (anggotaLevels[0] >= 5) { status = "VIP 1"; statusColor = "bg-emerald-500/20 text-emerald-300 border-emerald-500/30"; bonusPeringkatForDisplay = 50;}
            
            const totalBonus = bonusTim + cumulativeBonusPeringkat; 
            const saldoAkun = depositAwal + totalBonus; 
            
            // --- PERBAIKAN LOGIKA BATASAN MODAL (REKURSI) SESUAI INSTRUKSI PYTHON ---
            function getMemberContribution(level) {
                if (level === 0) return 30;
                return 500 + (5 * getMemberContribution(level - 1));
            }

            let batasanModal = 500; 

            if (simulationMode === 'recruit_lv1') {
                batasanModal += anggotaLevels[0] * 30;
            } else {
                Object.values(memberState).forEach(member => {
                    if (member.isLeader) {
                        batasanModal += getMemberContribution(member.duplicationLevels);
                    } else {
                        batasanModal += 30;
                    }
                });
            }

            let sinyalKe3 = "Tidak Aktif"; 
            const isALeader = memberState.A.isLeader;
            const isBLeader = memberState.B.isLeader;
            const isCLeader = memberState.C.isLeader;
            const isDLeader = memberState.D.isLeader;
            const isELeader = memberState.E.isLeader;
            const andaIsVip1 = (anggotaLevels[0] >= 5);

            if (andaIsVip1) {
                if (isALeader && isBLeader && isCLeader && isDLeader && isELeader) {
                    sinyalKe3 = "Permanen";
                } 
                else if (isBLeader && isDLeader) {
                    sinyalKe3 = "Tidak Aktif"; 
                } 
                else if (isALeader && isBLeader && isCLeader) {
                    sinyalKe3 = "20 Hari";
                }
                else if (
                    (!isALeader && !isBLeader && !isCLeader && !isDLeader && !isELeader) || 
                    (isALeader  && !isBLeader && !isCLeader && !isDLeader && !isELeader)    
                ) {
                    sinyalKe3 = "5 Hari";
                }
            }

            let sinyalKe4 = "Belum Aktif"; if (anggotaLevels[1] > 0) { sinyalKe4 = "10 Hari"; } let bonusVolume = "0%"; if (anggotaLevels[0] >= 5) { if (totalAnggota >= 3501) bonusVolume = "5%"; else if (totalAnggota >= 1601) bonusVolume = "3.5%"; else if (totalAnggota >= 901) bonusVolume = "3%"; else if (totalAnggota >= 501) bonusVolume = "2.5%"; else if (totalAnggota >= 351) bonusVolume = "2%"; else if (totalAnggota >= 201) bonusVolume = "1.5%"; else if (totalAnggota >= 101) bonusVolume = "1%"; else if (totalAnggota >= 31) bonusVolume = "0.5%"; else if (totalAnggota >= 5) bonusVolume = "0.3%"; }
            
            const isVip9 = status === "VIP 9"; 
            const juaraMsg = document.getElementById('juara-message-container'); 
            const fokusMsg = document.getElementById('fokus-message'); 
            const championsAudio = document.getElementById('champions-audio');
            
            if (isVip9) { 
                startConfetti(); 
                if(juaraMsg) juaraMsg.classList.remove('hidden'); 
                if(fokusMsg) fokusMsg.classList.add('hidden'); 
                if (championsAudio && championsAudio.paused) {
                    championsAudio.currentTime = 0; 
                    championsAudio.loop = true; 
                    championsAudio.play().catch(e => {console.error("Champions Audio play failed:", e)});
                }
            } else { 
                stopConfetti(); 
                if(juaraMsg) juaraMsg.classList.add('hidden'); 
                if(fokusMsg) fokusMsg.classList.remove('hidden'); 
                if (championsAudio && !championsAudio.paused) {
                    championsAudio.pause();
                    championsAudio.currentTime = 0;
                }
            }
            
            const andaLbl = document.getElementById('anda-label'); const ktLbl = document.getElementById('ketua-tim-label'); const crownIcn = document.getElementById('crown-icon'); if (anggotaLevels[0] >= 5) { if(andaLbl){andaLbl.classList.remove('bg-blue-500/20','text-blue-300','border-blue-500/30'); andaLbl.classList.add('bg-amber-500/20','text-amber-300','border-amber-500/30');} if(ktLbl) ktLbl.innerHTML = `<span class="text-xs font-bold text-emerald-400 drop-shadow-sm">Ketua Tim</span>`; if(crownIcn) crownIcn.classList.remove('hidden'); } else { if(andaLbl){andaLbl.classList.remove('bg-amber-500/20','text-amber-300','border-amber-500/30'); andaLbl.classList.add('bg-blue-500/20','text-blue-300','border-blue-500/30');} if(ktLbl) ktLbl.innerHTML = ''; if(crownIcn) crownIcn.classList.add('hidden'); } 
             if (simulationMode === 'duplicating_lv1') { Object.entries(memberState).forEach(([letter, member]) => { const label = document.getElementById(`kt-label-${letter}`); const cb = document.getElementById(`member${letter}`); if(cb) cb.checked = member.isLeader; if(label) label.innerHTML = member.isLeader ? `<span class="text-base drop-shadow-[0_0_5px_rgba(251,191,36,0.5)]">ðŸ‘‘</span>` : ''; }); }
            renderDuplicationTree(); 
            
            // --- UI UPDATES ---
            const elTotalBonus=document.getElementById('kpiTotalBonus'); if(elTotalBonus) elTotalBonus.textContent=`+${totalBonus.toLocaleString('id-ID')} USDT`; 
            const elKpiStatus=document.getElementById('kpiStatus'); if(elKpiStatus) elKpiStatus.innerHTML=`<span class="px-3 py-1 rounded-full font-bold text-xs border backdrop-blur-sm transition-all duration-300 ${statusColor}">${status}</span>`; 
            const elBonusPeringkat=document.getElementById('kpiBonusPeringkat'); if(elBonusPeringkat) elBonusPeringkat.textContent=bonusPeringkatForDisplay>0?`+${bonusPeringkatForDisplay.toLocaleString('id-ID')} USDT`:''; 
            const elBonusVol=document.getElementById('resBonusVolume'); if(elBonusVol) elBonusVol.textContent=bonusVolume; 
            const elSaldo=document.getElementById('resModalAwalPanel'); if(elSaldo) elSaldo.textContent=`${saldoAkun.toLocaleString('id-ID')} USDT`; 
            
            const elRef1=document.getElementById('resBonusReveral1'); if(elRef1) elRef1.textContent=`@300 USDT`; 
            const elRef2=document.getElementById('resBonusReveral2'); if(elRef2) elRef2.textContent=`@300 USDT`; 
            const elBonusTim=document.getElementById('resBonusTim'); if(elBonusTim) elBonusTim.textContent=`20 USDT`; 
            
            const elBatas=document.getElementById('resBatasanModal'); if(elBatas) elBatas.textContent=`${batasanModal.toLocaleString('id-ID')} USDT`; 
            const elTotalAnggota=document.getElementById('resTotalAnggotaPanel'); if(elTotalAnggota) elTotalAnggota.textContent=`${totalAnggotaTim.toLocaleString('id-ID')} Anggota`; 
            
            // Elegant Check & Cross Icons for Status
            const check = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 mr-1.5 text-emerald-400"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" /></svg>`; 
            const cross = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 mr-1.5 text-slate-500/70"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" /></svg>`;
            
            const sinyalSSM = `<div class="text-xs text-emerald-400 font-medium flex items-center pt-1 whitespace-nowrap"><span class="flex items-center">${check}<span class="tracking-tight">Sinyal Siang & Malam</span></span></div>`; 
            const sinyal3 = `<div class="text-xs ${sinyalKe3 !== 'Tidak Aktif' ? 'text-emerald-400' : 'text-slate-500'} font-medium flex items-center pt-1 whitespace-nowrap"> <span class="flex items-center"> ${sinyalKe3 !== 'Tidak Aktif' ? check : cross} <span class="tracking-tight">Sinyal ke-3: ${sinyalKe3}</span> </span> </div>`; 
            const sinyal4 = `<div class="text-xs ${sinyalKe4 !== 'Belum Aktif' ? 'text-emerald-400' : 'text-slate-500'} font-medium flex items-center pt-1 whitespace-nowrap"> <span class="flex items-center"> ${sinyalKe4 !== 'Belum Aktif' ? check : cross} <span class="tracking-tight">Sinyal ke-4: ${sinyalKe4}</span> </span> </div>`; 
            const sinyalContainer = document.getElementById('sinyalContainer'); if (sinyalContainer) sinyalContainer.innerHTML = sinyalSSM + sinyal3 + sinyal4;
            
            pulseElement('kpiTotalBonus'); pulseElement('resModalAwalPanel');
        }

        // --- Event Listener DOMContentLoaded (Setup Awal) ---
        document.addEventListener('DOMContentLoaded', () => {
            const enterButton = document.getElementById('enter-button');
            const splashScreen = document.getElementById('splash-screen');
            const dashboardContent = document.getElementById('dashboard-content');
            
            if (enterButton && splashScreen && dashboardContent) { 
                enterButton.addEventListener('click', () => {
                    console.log("Enter button clicked!"); 
                    const elem = document.documentElement;
                    if (elem.requestFullscreen) elem.requestFullscreen().catch(err => { console.error("Fullscreen error:", err); }); 
                    else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
                    
                    splashScreen.style.animation = 'fadeOut 0.5s ease-out forwards'; 
                    setTimeout(() => {
                        splashScreen.style.display = 'block'; 
                        dashboardContent.style.animation = 'fadeIn 0.5s ease-out forwards'; 
                        document.body.style.overflow = 'auto';
                        if (typeof initializeSimulator === 'function') {
                             initializeSimulator(); 
                        } else {
                             console.error("InitializeSimulator function not found!");
                        }
                    }, 500);
                });
            } else {
                 if (!splashScreen && dashboardContent) {
                      dashboardContent.style.display = 'block'; 
                      document.body.style.overflow = 'auto'; 
                      if (typeof initializeSimulator === 'function') initializeSimulator();
                 }
            }
            
            if ('serviceWorker' in navigator) { window.addEventListener('load', () => { navigator.serviceWorker.register('/BenefitPlan/sw.js').then(reg => {}, err => {}); }); }
            const audioButton = document.getElementById('play-audio-button'); const audio = document.getElementById('tutorial-audio');
            const speakerIcon = document.getElementById('speaker-icon'); const speakerOffIcon = document.getElementById('speaker-off-icon');
            if (audioButton && audio && speakerIcon && speakerOffIcon) { 
                audioButton.addEventListener('click', () => { 
                    const championsAudio = document.getElementById('champions-audio');
                    if (championsAudio && !championsAudio.paused) {
                        championsAudio.pause();
                        championsAudio.currentTime = 0;
                    }
                    if (audio.paused) audio.play().catch(e => {console.error("Audio play failed:", e)}); 
                    else audio.pause(); 
                });
                audio.onplay = () => { speakerIcon.classList.add('hidden'); speakerOffIcon.classList.remove('hidden'); };
                audio.onpause = () => { speakerIcon.classList.remove('hidden'); speakerOffIcon.classList.add('hidden'); };
            }
        });
    </script>
</body>
</html>
